const products = {
  "table #1": {
    appetizers: [
      {
        name: "French Fries",
        note: "A Fresh Crispy French Fries With Ketchup And Mayonnaise.",
        price: "10",
        url: "images/frenchfries.png",
      },
      {
        name: "Green Salad",
        note: "A Fresh Classic Green Salad Consist Of Lettuce, Sliced Apple, Tomato And Pomegranate Pieces Above It.",
        price: "12",
        url: "images/greensalad.png",
      },
      {
        name: "Onions Rings",
        note: "A Fresh Crispy Onions Rings With Ketchup.",
        price: "7",
        url: "images/onionsrings.png",
      },
      {
        name: "Soup",
        note: "A Warm Lentil Soup With Croutons, Lemon And Rosemary.",
        price: "9",
        url: "images/soup.png",
      },
    ],
    maincourse: [
      {
        name: "Cheese Burger",
        note: "Classic Cheeseburger Begins With A 100% Pure Beef Burger Seasoned With Just A Pinch Of Salt And Pepper And A Slice Of Tomato And Lettuce.",
        price: "20",
        url: "images/cheeseburger.png ",
      },
      {
        name: "Rice",
        note: "Traditional Japanese Rice With Original Japanese Spices.",
        price: "10",
        url: "images/rice.png",
      },
      {
        name: "Pizza",
        note: "Classic Delicious Pepperoni Pizza With Fresh Mozzarella And Parmesan Cheese, Italian Tomato Sauce.",
        price: "24",
        url: "images/pizza.png",
      },
      {
        name: "Pasta",
        note: "Traditional Tasty Italian Pasta With Original Italian Spices, Fresh Parmesan Cheese And Chicken.",
        price: "24",
        url: "images/pasta.png",
      },
      {
        name: "Sushi",
        note: "A Japanese Fresh Sushi With Soya And Wasabi Sauce.",
        price: "37",
        url: "images/sushi.png",
      },
      {
        name: "Steak",
        note: "A 100% Pure Beef Meat Grilled With A Pure Cow Butter.",
        price: "46",
        url: "images/steak.png",
      },
    ],
    dessertsanddrinks: [
      {
        name: "Souffle",
        note: "A Classic French Chocolate Souffle.",
        price: "13",
        url: "images/Souffle.png",
      },
      {
        name: "Cake",
        note: "Classic Chocolate Cake With Chocolate Sauce And Strawberry.",
        price: "15",
        url: "images/chocolatecake.png",
      },
      {
        name: "Mousse",
        note: "French Chocolate Mousse With A White Cream Above It And Blueberries.",
        price: "10",
        url: "images/mousse.png",
      },
      {
        name: "Coffee",
        note: "Hot Black Coffee.",
        price: "6",
        url: "images/coffee.png",
      },
      {
        name: "Orange Juice",
        note: "Fresh Sugar Free Orange Juice.",
        price: "7",
        url: "images/orangejuice.png",
      },
      {
        name: "Soft Drinks",
        note: "Coca-Cola, Diet Coke, Sprite, Fanta, 7up.",
        price: "6",
        url: "images/softdrinks.png",
      },
    ],
  },
  "table #2": {
    appetizers: [
      {
        name: "French Fries",
        note: "A Fresh Crispy French Fries With Ketchup And Mayonnaise.",
        price: "10",
        url: "images/frenchfries.png",
      },
      {
        name: "Green Salad",
        note: "A Fresh Classic Green Salad Consist Of Lettuce, Sliced Apple, Tomato And Pomegranate Pieces Above It.",
        price: "12",
        url: "images/greensalad.png",
      },
      {
        name: "Onions Rings",
        note: "A Fresh Crispy Onions Rings With Ketchup.",
        price: "7",
        url: "images/onionsrings.png",
      },
      {
        name: "Soup",
        note: "A Warm Lentil Soup With Croutons, Lemon And Rosemary.",
        price: "9",
        url: "images/soup.png",
      },
    ],
    maincourse: [
      {
        name: "Cheese Burger",
        note: "Classic Cheeseburger Begins With A 100% Pure Beef Burger Seasoned With Just A Pinch Of Salt And Pepper And A Slice Of Tomato And Lettuce.",
        price: "20",
        url: "images/cheeseburger.png ",
      },
      {
        name: "Rice",
        note: "Traditional Japanese Rice With Original Japanese Spices.",
        price: "10",
        url: "images/rice.png",
      },
      {
        name: "Pizza",
        note: "Classic Delicious Pepperoni Pizza With Fresh Mozzarella And Parmesan Cheese, Italian Tomato Sauce.",
        price: "24",
        url: "images/pizza.png",
      },
      {
        name: "Pasta",
        note: "Traditional Tasty Italian Pasta With Original Italian Spices, Fresh Parmesan Cheese And Chicken.",
        price: "24",
        url: "images/pasta.png",
      },
      {
        name: "Sushi",
        note: "A Japanese Fresh Sushi With Soya And Wasabi Sauce.",
        price: "37",
        url: "images/sushi.png",
      },
      {
        name: "Steak",
        note: "A 100% Pure Beef Meat Grilled With A Pure Cow Butter.",
        price: "46",
        url: "images/steak.png",
      },
    ],
    dessertsanddrinks: [
      {
        name: "Souffle",
        note: "A Classic French Chocolate Souffle.",
        price: "13",
        url: "images/Souffle.png",
      },
      {
        name: "Cake",
        note: "Classic Chocolate Cake With Chocolate Sauce And Strawberry.",
        price: "15",
        url: "images/chocolatecake.png",
      },
      {
        name: "Mousse",
        note: "French Chocolate Mousse With A White Cream Above It And Blueberries.",
        price: "10",
        url: "images/mousse.png",
      },
      {
        name: "Coffee",
        note: "Hot Black Coffee.",
        price: "6",
        url: "images/coffee.png",
      },
      {
        name: "Orange Juice",
        note: "Fresh Sugar Free Orange Juice.",
        price: "7",
        url: "images/orangejuice.png",
      },
      {
        name: "Soft Drinks",
        note: "Coca-Cola, Diet Coke, Sprite, Fanta, 7up.",
        price: "6",
        url: "images/softdrinks.png",
      },
    ],
  },
  "table #3": {
    appetizers: [
      {
        name: "French Fries",
        note: "A Fresh Crispy French Fries With Ketchup And Mayonnaise.",
        price: "10",
        url: "images/frenchfries.png",
      },
      {
        name: "Green Salad",
        note: "A Fresh Classic Green Salad Consist Of Lettuce, Sliced Apple, Tomato And Pomegranate Pieces Above It.",
        price: "12",
        url: "images/greensalad.png",
      },
      {
        name: "Onions Rings",
        note: "A Fresh Crispy Onions Rings With Ketchup.",
        price: "7",
        url: "images/onionsrings.png",
      },
      {
        name: "Soup",
        note: "A Warm Lentil Soup With Croutons, Lemon And Rosemary.",
        price: "9",
        url: "images/soup.png",
      },
    ],
    maincourse: [
      {
        name: "Cheese Burger",
        note: "Classic Cheeseburger Begins With A 100% Pure Beef Burger Seasoned With Just A Pinch Of Salt And Pepper And A Slice Of Tomato And Lettuce.",
        price: "20",
        url: "images/cheeseburger.png ",
      },
      {
        name: "Rice",
        note: "Traditional Japanese Rice With Original Japanese Spices.",
        price: "10",
        url: "images/rice.png",
      },
      {
        name: "Pizza",
        note: "Classic Delicious Pepperoni Pizza With Fresh Mozzarella And Parmesan Cheese, Italian Tomato Sauce.",
        price: "24",
        url: "images/pizza.png",
      },
      {
        name: "Pasta",
        note: "Traditional Tasty Italian Pasta With Original Italian Spices, Fresh Parmesan Cheese And Chicken.",
        price: "24",
        url: "images/pasta.png",
      },
      {
        name: "Sushi",
        note: "A Japanese Fresh Sushi With Soya And Wasabi Sauce.",
        price: "37",
        url: "images/sushi.png",
      },
      {
        name: "Steak",
        note: "A 100% Pure Beef Meat Grilled With A Pure Cow Butter.",
        price: "46",
        url: "images/steak.png",
      },
    ],
    dessertsanddrinks: [
      {
        name: "Souffle",
        note: "A Classic French Chocolate Souffle.",
        price: "13",
        url: "images/Souffle.png",
      },
      {
        name: "Cake",
        note: "Classic Chocolate Cake With Chocolate Sauce And Strawberry.",
        price: "15",
        url: "images/chocolatecake.png",
      },
      {
        name: "Mousse",
        note: "French Chocolate Mousse With A White Cream Above It And Blueberries.",
        price: "10",
        url: "images/mousse.png",
      },
      {
        name: "Coffee",
        note: "Hot Black Coffee.",
        price: "6",
        url: "images/coffee.png",
      },
      {
        name: "Orange Juice",
        note: "Fresh Sugar Free Orange Juice.",
        price: "7",
        url: "images/orangejuice.png",
      },
      {
        name: "Soft Drinks",
        note: "Coca-Cola, Diet Coke, Sprite, Fanta, 7up.",
        price: "6",
        url: "images/softdrinks.png",
      },
    ],
  },
  "table #4": {
    appetizers: [
      {
        name: "French Fries",
        note: "A Fresh Crispy French Fries With Ketchup And Mayonnaise.",
        price: "10",
        url: "images/frenchfries.png",
      },
      {
        name: "Green Salad",
        note: "A Fresh Classic Green Salad Consist Of Lettuce, Sliced Apple, Tomato And Pomegranate Pieces Above It.",
        price: "12",
        url: "images/greensalad.png",
      },
      {
        name: "Onions Rings",
        note: "A Fresh Crispy Onions Rings With Ketchup.",
        price: "7",
        url: "images/onionsrings.png",
      },
      {
        name: "Soup",
        note: "A Warm Lentil Soup With Croutons, Lemon And Rosemary.",
        price: "9",
        url: "images/soup.png",
      },
    ],
    maincourse: [
      {
        name: "Cheese Burger",
        note: "Classic Cheeseburger Begins With A 100% Pure Beef Burger Seasoned With Just A Pinch Of Salt And Pepper And A Slice Of Tomato And Lettuce.",
        price: "20",
        url: "images/cheeseburger.png ",
      },
      {
        name: "Rice",
        note: "Traditional Japanese Rice With Original Japanese Spices.",
        price: "10",
        url: "images/rice.png",
      },
      {
        name: "Pizza",
        note: "Classic Delicious Pepperoni Pizza With Fresh Mozzarella And Parmesan Cheese, Italian Tomato Sauce.",
        price: "24",
        url: "images/pizza.png",
      },
      {
        name: "Pasta",
        note: "Traditional Tasty Italian Pasta With Original Italian Spices, Fresh Parmesan Cheese And Chicken.",
        price: "24",
        url: "images/pasta.png",
      },
      {
        name: "Sushi",
        note: "A Japanese Fresh Sushi With Soya And Wasabi Sauce.",
        price: "37",
        url: "images/sushi.png",
      },
      {
        name: "Steak",
        note: "A 100% Pure Beef Meat Grilled With A Pure Cow Butter.",
        price: "46",
        url: "images/steak.png",
      },
    ],
    dessertsanddrinks: [
      {
        name: "Souffle",
        note: "A Classic French Chocolate Souffle.",
        price: "13",
        url: "images/Souffle.png",
      },
      {
        name: "Cake",
        note: "Classic Chocolate Cake With Chocolate Sauce And Strawberry.",
        price: "15",
        url: "images/chocolatecake.png",
      },
      {
        name: "Mousse",
        note: "French Chocolate Mousse With A White Cream Above It And Blueberries.",
        price: "10",
        url: "images/mousse.png",
      },
      {
        name: "Coffee",
        note: "Hot Black Coffee.",
        price: "6",
        url: "images/coffee.png",
      },
      {
        name: "Orange Juice",
        note: "Fresh Sugar Free Orange Juice.",
        price: "7",
        url: "images/orangejuice.png",
      },
      {
        name: "Soft Drinks",
        note: "Coca-Cola, Diet Coke, Sprite, Fanta, 7up.",
        price: "6",
        url: "images/softdrinks.png",
      },
    ],
  },
  "table #5": {
    appetizers: [
      {
        name: "French Fries",
        note: "A Fresh Crispy French Fries With Ketchup And Mayonnaise.",
        price: "10",
        url: "images/frenchfries.png",
      },
      {
        name: "Green Salad",
        note: "A Fresh Classic Green Salad Consist Of Lettuce, Sliced Apple, Tomato And Pomegranate Pieces Above It.",
        price: "12",
        url: "images/greensalad.png",
      },
      {
        name: "Onions Rings",
        note: "A Fresh Crispy Onions Rings With Ketchup.",
        price: "7",
        url: "images/onionsrings.png",
      },
      {
        name: "Soup",
        note: "A Warm Lentil Soup With Croutons, Lemon And Rosemary.",
        price: "9",
        url: "images/soup.png",
      },
    ],
    maincourse: [
      {
        name: "Cheese Burger",
        note: "Classic Cheeseburger Begins With A 100% Pure Beef Burger Seasoned With Just A Pinch Of Salt And Pepper And A Slice Of Tomato And Lettuce.",
        price: "20",
        url: "images/cheeseburger.png ",
      },
      {
        name: "Rice",
        note: "Traditional Japanese Rice With Original Japanese Spices.",
        price: "10",
        url: "images/rice.png",
      },
      {
        name: "Pizza",
        note: "Classic Delicious Pepperoni Pizza With Fresh Mozzarella And Parmesan Cheese, Italian Tomato Sauce.",
        price: "24",
        url: "images/pizza.png",
      },
      {
        name: "Pasta",
        note: "Traditional Tasty Italian Pasta With Original Italian Spices, Fresh Parmesan Cheese And Chicken.",
        price: "24",
        url: "images/pasta.png",
      },
      {
        name: "Sushi",
        note: "A Japanese Fresh Sushi With Soya And Wasabi Sauce.",
        price: "37",
        url: "images/sushi.png",
      },
      {
        name: "Steak",
        note: "A 100% Pure Beef Meat Grilled With A Pure Cow Butter.",
        price: "46",
        url: "images/steak.png",
      },
    ],
    dessertsanddrinks: [
      {
        name: "Souffle",
        note: "A Classic French Chocolate Souffle.",
        price: "13",
        url: "images/Souffle.png",
      },
      {
        name: "Cake",
        note: "Classic Chocolate Cake With Chocolate Sauce And Strawberry.",
        price: "15",
        url: "images/chocolatecake.png",
      },
      {
        name: "Mousse",
        note: "French Chocolate Mousse With A White Cream Above It And Blueberries.",
        price: "10",
        url: "images/mousse.png",
      },
      {
        name: "Coffee",
        note: "Hot Black Coffee.",
        price: "6",
        url: "images/coffee.png",
      },
      {
        name: "Orange Juice",
        note: "Fresh Sugar Free Orange Juice.",
        price: "7",
        url: "images/orangejuice.png",
      },
      {
        name: "Soft Drinks",
        note: "Coca-Cola, Diet Coke, Sprite, Fanta, 7up.",
        price: "6",
        url: "images/softdrinks.png",
      },
    ],
  },
  "table #6": {
    appetizers: [
      {
        name: "French Fries",
        note: "A Fresh Crispy French Fries With Ketchup And Mayonnaise.",
        price: "10",
        url: "images/frenchfries.png",
      },
      {
        name: "Green Salad",
        note: "A Fresh Classic Green Salad Consist Of Lettuce, Sliced Apple, Tomato And Pomegranate Pieces Above It.",
        price: "12",
        url: "images/greensalad.png",
      },
      {
        name: "Onions Rings",
        note: "A Fresh Crispy Onions Rings With Ketchup.",
        price: "7",
        url: "images/onionsrings.png",
      },
      {
        name: "Soup",
        note: "A Warm Lentil Soup With Croutons, Lemon And Rosemary.",
        price: "9",
        url: "images/soup.png",
      },
    ],
    maincourse: [
      {
        name: "Cheese Burger",
        note: "Classic Cheeseburger Begins With A 100% Pure Beef Burger Seasoned With Just A Pinch Of Salt And Pepper And A Slice Of Tomato And Lettuce.",
        price: "20",
        url: "images/cheeseburger.png ",
      },
      {
        name: "Rice",
        note: "Traditional Japanese Rice With Original Japanese Spices.",
        price: "10",
        url: "images/rice.png",
      },
      {
        name: "Pizza",
        note: "Classic Delicious Pepperoni Pizza With Fresh Mozzarella And Parmesan Cheese, Italian Tomato Sauce.",
        price: "24",
        url: "images/pizza.png",
      },
      {
        name: "Pasta",
        note: "Traditional Tasty Italian Pasta With Original Italian Spices, Fresh Parmesan Cheese And Chicken.",
        price: "24",
        url: "images/pasta.png",
      },
      {
        name: "Sushi",
        note: "A Japanese Fresh Sushi With Soya And Wasabi Sauce.",
        price: "37",
        url: "images/sushi.png",
      },
      {
        name: "Steak",
        note: "A 100% Pure Beef Meat Grilled With A Pure Cow Butter.",
        price: "46",
        url: "images/steak.png",
      },
    ],
    dessertsanddrinks: [
      {
        name: "Souffle",
        note: "A Classic French Chocolate Souffle.",
        price: "13",
        url: "images/Souffle.png",
      },
      {
        name: "Cake",
        note: "Classic Chocolate Cake With Chocolate Sauce And Strawberry.",
        price: "15",
        url: "images/chocolatecake.png",
      },
      {
        name: "Mousse",
        note: "French Chocolate Mousse With A White Cream Above It And Blueberries.",
        price: "10",
        url: "images/mousse.png",
      },
      {
        name: "Coffee",
        note: "Hot Black Coffee.",
        price: "6",
        url: "images/coffee.png",
      },
      {
        name: "Orange Juice",
        note: "Fresh Sugar Free Orange Juice.",
        price: "7",
        url: "images/orangejuice.png",
      },
      {
        name: "Soft Drinks",
        note: "Coca-Cola, Diet Coke, Sprite, Fanta, 7up.",
        price: "6",
        url: "images/softdrinks.png",
      },
    ],
  },
};

const changeProducts = (value) => {
  let titleLists = ["appetizers", "maincourse", "dessertsanddrinks"];
  titleLists.map((item) => {
    let selectedTableProducts = products[value];
    let html = document.getElementById(`${item}`);
    html.innerHTML = "";
    selectedTableProducts[item].map(
      (product) =>
        (html.innerHTML += `<div class="box">
            <div class="image">
                <img src="${product.url}" alt="${product.name}" />
            </div>

            <div class="content">
                <h3>${product.name}</h3>

                <p>
                ${product.note}
                </p>
                <p>${product.price} SAR</p>
                <input type="number" onchange="localStorage.setItem('qty',this.value)" class="quantity" name="quantity" min="1" placeholder="1" />
                <button class="btn" type="button" onclick="handleAddCart(event)" data-value='${
                  product.name + "&" + product.price
                }'>
                    ADD TO CART
                </button>
            </div>
        </div>`)
    );
  });
};

const handleAddCart = (event) => {
  let productInfo = event.target.dataset["value"].split("&");
  let tableName = document.getElementById("drop").value;
  let store_info = localStorage.getItem("order_details");
  let qty = localStorage.getItem("qty");
  let newEntry = {
    name: productInfo[0],
    price: productInfo[1],
    qty: qty ? qty : 1,
  };
  let parseValue = store_info ? JSON.parse(store_info) : {};
  let oldTableEntrys = Object.keys(parseValue);

  if (store_info && oldTableEntrys.includes(`${tableName}`)) {
    let oldEntries = [];
    parseValue[`${tableName}`].map((item) => {
      oldEntries.push(item.name);
    });
    if (oldEntries.includes(productInfo[0])) {
      alert("Product already in cart!");
      localStorage.setItem("qty", "1");
      return;
    } else {
      parseValue[`${tableName}`].push(newEntry);
      localStorage.setItem("order_details", JSON.stringify(parseValue));
    }
  } else {
    info = { ...parseValue };
    info[`${tableName}`] = [newEntry];
    localStorage.setItem("order_details", JSON.stringify(info));
  }
  alert(`${productInfo[0]} has added on cart`)
};

const handleOrder = () => {
  const cartItems = localStorage.getItem("order_details");
  if (cartItems) {
    let parsedIitems = JSON.parse(cartItems);
    let html = `<table id="myTable">
    <caption>
        Order list
    </caption>
    <thead>
        <tr>
            <th>Table number</th>
            <th>Order</th>
            <th id="price">Price</th>
            <th>Quantity</th>
            <th>Total</th>
            <th>Print invoice</th>
        </tr>
    </thead>
    <tbody>`;
    Object.keys(parsedIitems).map((product) => {
      let orders = "";
      let prices = "";
      let quantities = "";
      let totalPrice = 0;
      parsedIitems[product].map((item) => {
        orders += `${item.name} <br>`;
        prices += `${item.price} <br>`;
        quantities += `${item.qty} <br>`;
        totalPrice += parseInt(item.price) * parseInt(item.qty);
      });

      let tableBody = `<tr><td>${product}</td><td>${orders}</td><td>${prices}</td><td>${quantities}</td><td><div class="wrapper">${totalPrice}</div></td><td><div class="wrapper">
          <button class="btn" type="button" data-value='${product}' onclick="handlePrint(event)">
              Print
          </button>
      </div></td>`;
      html += tableBody;
    });

    html += `</tbody></table>`;
    document.getElementById('orderLists').innerHTML = html;
  } else {
    alert("There is no product in your cart!!");
  }
};

const handlePrint = (event)=>{
  let tableName = event.target.dataset['value'];
  const cartItems = localStorage.getItem("order_details");
 
  if (cartItems) {
    let parsedItems = JSON.parse(cartItems);
    let selectedLists = parsedItems[tableName];
    let pdfHtml = `<table id="myTable" >
    <caption>
        ${tableName}
    </caption>
    <thead>
        <tr>
            <th>Item</th>
            <th>Quentity</th>
            <th>Price</th>
        </tr>
    </thead>
    <tbody>`;

    selectedLists.map(item =>{
      let tbRow = `<tr><td>${item.name}</td><td>${item.qty}</td><td>${parseInt(item.price) * parseInt(item.qty)}</td></tr>`;
      pdfHtml += tbRow;
    })
    pdfHtml += "</tbody></table>";
    document.body.innerHTML = pdfHtml;
    delete parsedItems[tableName];
    localStorage.setItem('order_details',JSON.stringify(parsedItems));
    let tables = localStorage.getItem('tableNumber').split(',')
    let current_table = tableName.substr(tableName.length - 1);
    tables.pop(tables.indexOf(`${current_table}`))

    localStorage.setItem('tableNumber',tables.toString())
    window.print();
    window.location.reload()

    


  }

}
	  handleOrder()